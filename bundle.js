!function(t){function e(e){for(var n,r,s=e[0],c=e[1],u=e[2],d=0,p=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&p.push(a[r][0]),a[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);for(l&&l(e);p.length;)p.shift()();return i.push.apply(i,u||[]),o()}function o(){for(var t,e=0;e<i.length;e++){for(var o,r=i[e],s=!0,c=1;c<r.length;c++)o=r[c],0!==a[o]&&(s=!1);s&&(i.splice(e--,1),t=n(n.s=r[0]))}return t}function n(e){if(r[e])return r[e].exports;var o=r[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var r={},a={0:0},i=[];n.e=function(t){var e=[],o=a[t];if(0!==o)if(o)e.push(o[2]);else{var r=new Promise((function(e,n){o=a[t]=[e,n]}));e.push(o[2]=r);var i,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(t){return n.p+""+({}[t]||t)+".bundle.js"}(t);var c=new Error;i=function(e){s.onerror=s.onload=null,clearTimeout(u);var o=a[t];if(0!==o){if(o){var n=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+n+": "+r+")",c.name="ChunkLoadError",c.type=n,c.request=r,o[1](c)}a[t]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:s})}),12e4);s.onerror=s.onload=i,document.head.appendChild(s)}return Promise.all(e)},n.m=t,n.c=r,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n.oe=function(t){throw console.error(t),t};var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;i.push([15,1]),o()}([function(t,e,o){"use strict";async function n(){let t=await f.getConnection();return new g.a(t)}function r(t=500){return function(e,o,n){const r=n.value;let a=0;return n.value=function(...e){event&&event.preventDefault(),clearInterval(a),a=setTimeout(()=>r.apply(this,e),t)},n}}function a(...t){const e=t.map(t=>document.querySelector(t));return function(t){const o=t,n=function(){const t=new o(...e);Object.getOwnPropertyNames(o.prototype).forEach(e=>{Reflect.hasMetadata("bindEvent",t,e)&&function(t,e){document.querySelector(e.seletor).addEventListener(e.event,o=>{e.prevent&&o.preventDefault(),t[e.propertyKey](o)})}(t,Reflect.getMetadata("bindEvent",t,e))})};return n.prototype=o.prototype,n}}function i(t){throw new Error(t+" é um parâmetro obrigatório")}function s(t=i("event"),e=i("selector"),o=!0){return function(n,r,a){return Reflect.defineMetadata("bindEvent",{event:t,seletor:e,prevent:o,propertyKey:r},Object.getPrototypeOf(n),r),a}}o.d(e,"e",(function(){return c.b})),o.d(e,"a",(function(){return l})),o.d(e,"f",(function(){return n})),o.d(e,"d",(function(){return r})),o.d(e,"c",(function(){return a})),o.d(e,"g",(function(){return i})),o.d(e,"b",(function(){return s}));var c=o(3);class u{static create(t,e,o){return new Proxy(t,{get:(t,n)=>u._ehFuncao(t[n])&&e.includes(n)?function(){console.log(`"${n}" disparou a armadilha`),t[n].apply(t,arguments),o(t)}:t[n],set(t,n,r){const a=Reflect.set(t,n,r);return e.includes(n)&&o(t),a}})}static _ehFuncao(t){return typeof t==typeof Function}}class l{constructor(t,e,...o){const n=u.create(t,o,t=>{e.update(t)});return e.update(t),n}}const d=["negociacoes"];let p=null,h=null;class f{constructor(){throw new Error("Não é possível criar instância dessa classe")}static getConnection(){return new Promise((t,e)=>{if(p)return t(p);const o=indexedDB.open("jscangaceiro",2);o.onupgradeneeded=t=>{f._createStores(t.target.result)},o.onsuccess=e=>{p=e.target.result,h=p.close.bind(p),p.close=()=>{throw new Error("Você não pode fechar diretamente a conexão")},t(p)},o.onerror=t=>{console.log(t.target.result),e(t.target.error.name)}})}static _createStores(t){d.forEach(e=>{t.objectStoreNames.contains(e)&&t.deleteObjectStore(e),t.createObjectStore(e,{autoIncrement:!0})})}static closeCommection(){p&&h()}}var g=o(4);o(5)},,function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var n=o(0);class r{constructor(t=Object(n.g)("data"),e=Object(n.g)("quantidade"),o=Object(n.g)("valor")){Object.assign(this,{_quantidade:e,_valor:o}),this._data=new Date(t.getTime()),Object.freeze(this)}get volume(){return this._quantidade*this._valor}get data(){return new Date(this._data.getTime())}get quantidade(){return this._quantidade}get valor(){return this._valor}equals(t){return JSON.stringify(this)==JSON.stringify(t)}}},function(t,e,o){"use strict";function n(t){return function(t){return t instanceof a||Object.getPrototypeOf(t)instanceof a}(t)?t.message:(console.log(t),"Não foi possível realizar a operação.")}o.d(e,"a",(function(){return r})),o.d(e,"b",(function(){return n}));class r extends Error{constructor(t=""){super(t),this.name=this.constructor.name}}const a=r},function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var n=o(2);class r{constructor(t){this._connection=t,this._store="negociacoes"}adiciona(t){return new Promise((e,o)=>{const n=this._connection.transaction([this._store],"readwrite").objectStore(this._store).add(t);n.onsuccess=()=>e(),n.onerror=t=>{console.log(t.target.error),o("Não foi possível salvar a negociação")}})}listaTodos(){return new Promise((t,e)=>{const o=[],r=this._connection.transaction([this._store],"readwrite").objectStore(this._store).openCursor();r.onsuccess=e=>{const r=e.target.result;if(r){const t=new n.a(r.value._data,r.value._quantidade,r.value._valor);o.push(t),r.continue()}else t(o)},r.onerror=t=>{console.log(t.target.error),e("Não foi possível listar as negociações")}})}apagaTodas(){return new Promise(t=>{const e=this._connection.transaction([this._store],"readwrite").objectStore(this._store).clear();e.onsuccess=()=>t(),e.onerror=()=>{console.log("Não foi possível apagar as negociações")}})}}},function(t,e,o){"use strict";o.d(e,"a",(function(){return n}));class n{_handleErrors(t){if(!t.ok)throw new Error(t.statusText);return t}get(t){return fetch(t).then(t=>this._handleErrors(t).then(t=>t.json()))}}},,,,,function(){},,,,,function(t,e,o){"use strict";function n(t,e,o,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce((function(o,n){return n(t,e,o)||o}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}o.r(e);o(7),o(8),o(10);var r=o(2);o(4);class a{constructor(){this._negociacoes=[],Object.freeze(this)}adiciona(t){this._negociacoes.push(t)}paraArray(){return[].concat(this._negociacoes)}get volumeTotal(){return this._negociacoes.reduce((t,e)=>t+e.volume,0)}esvazia(){this._negociacoes.length=0}}class i{constructor(t){this._elemento=document.querySelector(t)}template(){throw new Error("Você precisa implementar o método template")}update(t){this._elemento.innerHTML=this.template(t)}}class s extends i{template(t){return t.texto?`<p class="alert alert-info">${t.texto}</p>`:"<p></p>"}}var c=o(3);class u extends c.a{constructor(){super("A data deve estar no formato dd/mm/aaaa"),this.name=this.constructor.name}}class l{constructor(){throw new Error("Esta classe não pode ser instanciada!")}static paraTexto(t){return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}static paraData(t){if(!/\d{2}\/\d{2}\/\d{4}$/.test(t))throw new u;return new Date(...t.split("/").reverse().map((t,e)=>t-e%2))}}class d extends i{template(t){return`\n        <table class="table table-hover table-bordered">\n        <thead>\n            <tr>\n                <th>DATA</th>\n                <th>QUANTIDADE</th>\n                <th>VALOR</th>\n                <th>VOLUME</th>\n            </tr>\n        </thead>\n            ${t.paraArray().map(t=>`    <tr>\n                        <td>${l.paraTexto(t.data)}</td>\n                        <td>${t.quantidade}</td>\n                        <td>${t.valor}</td>\n                        <td>${t.volume}</td>\n                    </tr>\n                `).join("")}\n        <tbody>\n        </tbody>\n        \n        <tfoot>\n            <tr>\n                <td colspan="3"></td>\n                <td>${t.volumeTotal}</td>\n            </tr>\n        </tfoot>\n    </table> `}}class p{constructor(t=""){this._texto=t}get texto(){return this._texto}set texto(t){this._texto=t}}var h,f,g,m,v,b,_,y,w=o(0);new(h=Object(w.c)("#data","#quantidade","#valor"),f=Object(w.b)("submit",".form"),g=Object(w.d)(),m=Object(w.b)("click","#botao-apaga"),v=Object(w.b)("click","#botao-importa"),b=Object(w.d)(1e3),h((y=class{constructor(t,e,o){Object.assign(this,{_inputData:t,_inputQuantidade:e,_inputValor:o}),this._negociacoes=new w.a(new a,new d("#negociacoes"),"adiciona","esvazia"),this._mensagem=new w.a(new p,new s("#mensagemView"),"texto"),this._init()}async _init(){try{const t=await Object(w.f)();(await t.listaTodos()).forEach(t=>this._negociacoes.adiciona(t))}catch(t){this._mensagem.texto=Object(w.e)(t)}}async adiciona(t){try{t.preventDefault();const e=this._criaNegociacao(),o=await Object(w.f)();await o.adiciona(e),this._negociacoes.adiciona(e),this._mensagem.texto="Negociação adicionada com sucesso",this._limpaFormulorio()}catch(t){this._mensagem.texto=Object(w.e)(t)}}async apaga(){try{const t=await Object(w.f)();await t.apagaTodas(),this._negociacoes.esvazia(),this._mensagem.texto="Negociações apacada com sucesso"}catch(t){this._mensagem.texto=Object(w.e)(t)}}_criaNegociacao(){return new r.a(l.paraData(this._inputData.value),parseInt(this._inputQuantidade.value),parseFloat(this._inputValor.value))}_limpaFormulorio(){this._inputData.value="",this._inputQuantidade.value=1,this._inputValor.value=0,this._inputData.focus()}async importaNegociacoes(){try{const{NegociacoaServer:t}=await o.e(2).then(o.bind(null,17)),e=new t,n=await e.obterNegociacoesDoPeriodo();console.log(n),n.filter(t=>!this._negociacoes.paraArray().some(e=>t.equals(e))).forEach(t=>this._negociacoes.adiciona(t)),this._mensagem.texto="Negociações do período importadas com sucesso"}catch(t){this._mensagem.texto=Object(w.e)(t)}}},n(y.prototype,"adiciona",[f,g],Object.getOwnPropertyDescriptor(y.prototype,"adiciona"),y.prototype),n(y.prototype,"apaga",[m],Object.getOwnPropertyDescriptor(y.prototype,"apaga"),y.prototype),n(y.prototype,"importaNegociacoes",[v,b],Object.getOwnPropertyDescriptor(y.prototype,"importaNegociacoes"),y.prototype),_=y))||_);const O=new r.a(new Date,1,200),j=new Headers;j.set("Content-Type","application/json");const x=JSON.stringify(O);fetch("http://localhost:3000/negociacoes",{method:"POST",headers:j,body:x}).then(()=>console.log("Dados enviados com sucesso"))}]);